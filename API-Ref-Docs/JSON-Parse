/* Author: Dwiti Patanaik */

try {
        // Backend request template
		var backendRequest = {
							  "u_hm_tracking_number": "",
							  "u_hm_customer_po_number": "",
							  "u_hm_operating_unit": "",
							  "u_hm_solution_id": "",
							  "u_hm_source_system": "",
							  "u_hm_sales_order_status": "",
							  "u_hm_sales_order_number": "",
							  "u_hm_sales_order_timestamp": "",
							  "u_hm_contract_number": "",
							  "u_hm_contract_timestamp": "",
							  "u_hm_contract_status": ""
                             };
		  var actualRequest = context.getVariable("request.content");
		  var trackingnumber = context.getVariable("path.tracking-number");
		  
		  context.setVariable("clientRequest", actualRequest);
		  var actualRequestObj ="";
		  if(actualRequest){
		      actualRequestObj = JSON.parse(actualRequest);
		  }
		  if(actualRequestObj){
		      
    		  backendRequest.u_hm_tracking_number = trackingnumber;
    		  backendRequest.u_hm_customer_po_number = actualRequestObj.customerPoNumber;
    		  backendRequest.u_hm_operating_unit = actualRequestObj.operatingUnitId;
    		  backendRequest.u_hm_solution_id = actualRequestObj.solutionId;
    		  backendRequest.u_hm_source_system = actualRequestObj.sourceSystemName;
    		  
    		  if(actualRequestObj.salesOrder){
        		  backendRequest.u_hm_sales_order_number = actualRequestObj.salesOrder.orderNumber;
        		  backendRequest.u_hm_sales_order_status = actualRequestObj.salesOrder.orderStatus;
        		  backendRequest.u_hm_sales_order_timestamp = actualRequestObj.salesOrder.erpTimestamp;
    		  }
    		  
    		  if(actualRequestObj.serviceContract){
        		  backendRequest.u_hm_contract_number = actualRequestObj.serviceContract.contractNumber;
        		  backendRequest.u_hm_contract_status = actualRequestObj.serviceContract.contractStatus;
        		  backendRequest.u_hm_contract_timestamp = actualRequestObj.serviceContract.erpTimestamp;
    		  }
		  }
		  
		  context.setVariable("request.verb","POST");
		  context.setVariable("request.content", JSON.stringify(backendRequest));
		  context.setVariable("target.copy.pathsuffix","false");
		  
		  
}catch(error){
        throw error;
}